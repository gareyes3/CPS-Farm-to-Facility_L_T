Area_plot = (y/N_y)*(x/N_x)
#Calculating y and x limits where we could have a contaminated area
y_lim_min = 0+(sq_y/2)
y_lim_max = y-(sq_y/2)
x_lim_min = 0+(sq_x/2)
x_lim_max = x-(sq_x/2)
#edges of the plots including sides
x_edges_p<-seq(0,x,x/(N_x))
y_edges_p<-seq(0,y,y/N_y)
#establishing vortex of cont area
x_cords = runif(1,x_lim_min,x_lim_max)
y_cords = runif(1,y_lim_min,y_lim_max)
# Calculating area limits of contaminated area
x_min=x_cords-(sq_x/2)
x_max=x_cords+(sq_x/2)
y_max=y_cords+(sq_y/2)
y_min=y_cords-(sq_y/2)
df=data.frame("Acres"= seq(1,N_x*N_y),
"XMax" = rep(x_edges_p[1:N_x+1],N_y),
"XMin" = rep(x_edges_p[1:N_x],N_y),
"YMax" = rep(y_edges_p[1:N_y+1],N_x),
"YMin" = rep(y_edges_p[1:N_y],N_x))
df$textx = df$XMax-(df$XMax - df$XMin)/2
df$texty = df$YMax-(df$YMax - df$YMin)/2
ggplot()+
xlim(0,x)+
ylim(0,y)+
geom_rect(aes(xmin = x_min, xmax = x_max,ymin = y_min, ymax = y_max),fill = "red")+
geom_hline(yintercept = y_edges_p)+
geom_vline(xintercept = x_edges_p)+
geom_text(data = df, aes(x =textx, y = texty, label = Acres))+
coord_fixed(ratio = 1)+
theme_bw()+
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
labs(x = "Length (Plots)", y= "Width (Plots)")
}
S1_01_10<-Run_Model(Total_Sample_Size = 375,
n = 60,
CFU_lb = 10,
y = 2,
x = 5,
N_y = 2,
N_x = 5,
Percent_Cont = 0.1,
n_iters = 1000)
S1_1_10<-Run_Model(Total_Sample_Size = 375,
n = 60,
CFU_lb = 10,
y = 2,
x = 5,
N_y = 2,
N_x = 5,
Percent_Cont = 1,
n_iters = 1000)
S1_5_10<-Run_Model(Total_Sample_Size = 375,
n = 60,
CFU_lb = 10,
y = 2,
x = 5,
N_y = 2,
N_x = 5,
Percent_Cont = 5,
n_iters = 1000)
S1_10_10<-Run_Model(Total_Sample_Size = 375,
n = 60,
CFU_lb = 10,
y = 2,
x = 5,
N_y = 2,
N_x = 5,
Percent_Cont = 10,
n_iters = 1000)
boxplot(S1_01_10$OverallPower)
boxplot(S1_01_10$OverallPower,S1_11_10$OverallPower)
boxplot(S1_01_10$OverallPower,S1_1_10$OverallPower)
boxplot(S1_01_10$OverallPower,S1_1_10$OverallPower, S1_5_10$OverallPower)
boxplot(S1_01_10$OverallPower,S1_1_10$OverallPower, S1_5_10$OverallPower, S1_10_10$OverallPower)
#Visualization for 1, 10%
Create_Visualization(y = 2 ,
x = 5 ,
N_y = 2 ,
N_x = 5 ,
Percent_Cont= 10 )
#Visualization for 1, 10%
Create_Visualization(y = 2 ,
x = 5 ,
N_y = 2 ,
N_x = 5 ,
Percent_Cont= 1 )
#Visualization for 1, 10%
Create_Visualization(y = 2 ,
x = 5 ,
N_y = 2 ,
N_x = 5 ,
Percent_Cont= 5 )
#Visualization for 1, 10%
Create_Visualization(y = 2 ,
x = 5 ,
N_y = 2 ,
N_x = 5 ,
Percent_Cont= 0.1 )
#Visualization for 1, 10%
Create_Visualization(y = 2 ,
x = 5 ,
N_y = 2 ,
N_x = 5 ,
Percent_Cont= 0.01 )
#Visualization for 1, 10%
Create_Visualization(y = 2 ,
x = 5 ,
N_y = 2 ,
N_x = 5 ,
Percent_Cont= 0.001 )
#Visualization for 1, 10%
Create_Visualization(y = 2 ,
x = 5 ,
N_y = 2 ,
N_x = 5 ,
Percent_Cont= 0.01 )
#Visualization for 1, 10%
Create_Visualization(y = 2 ,
x = 5 ,
N_y = 2 ,
N_x = 5 ,
Percent_Cont= 0.1 )
#Visualization for 1, 10%
Create_Visualization(y = 2 ,
x = 5 ,
N_y = 2 ,
N_x = 5 ,
Percent_Cont= 11 )
#Visualization for 1, 10%
Create_Visualization(y = 2 ,
x = 5 ,
N_y = 2 ,
N_x = 5 ,
Percent_Cont= 50 )
#Visualization for 1, 10%
Create_Visualization(y = 2 ,
x = 5 ,
N_y = 2 ,
N_x = 5 ,
Percent_Cont= 10 )
#Visualization for 1, 10%
Create_Visualization(y = 2 ,
x = 5 ,
N_y = 2 ,
N_x = 5 ,
Percent_Cont= 100 )
S1_10_10<-Run_Model(Total_Sample_Size = 375,
n = 60,
CFU_lb = 10,
y = 2,
x = 5,
N_y = 2,
N_x = 5,
Percent_Cont = 100,
n_iters = 1000)
#Visualization for 1, 10%
Create_Visualization(y = 2 ,
x = 5 ,
N_y = 2 ,
N_x = 5 ,
Percent_Cont= 12)
#Visualization for 1, 10%
Create_Visualization(y = 2 ,
x = 5 ,
N_y = 2 ,
N_x = 5 ,
Percent_Cont= 20)
#Visualization for 1, 10%
Create_Visualization(y = 2 ,
x = 5 ,
N_y = 2 ,
N_x = 5 ,
Percent_Cont= 20)
#ggsave("Acre Representation.jpg", width =6, height = 5, units = "in", dpi = 300)
#Visualization for 1, 10%
Create_Visualization(y = 2 ,
x = 5 ,
N_y = 2 ,
N_x = 5 ,
Percent_Cont= 20)
#Visualization for 1, 10%
Create_Visualization(y = 2 ,
x = 5 ,
N_y = 2 ,
N_x = 5 ,
Percent_Cont= 20)
#Visualization for 1, 10%
Create_Visualization(y = 2 ,
x = 5 ,
N_y = 2 ,
N_x = 5 ,
Percent_Cont= 20)
#Visualization for 1, 10%
Create_Visualization(y = 2 ,
x = 5 ,
N_y = 2 ,
N_x = 5 ,
Percent_Cont= 20)
#Visualization for 1, 10%
Create_Visualization(y = 2 ,
x = 5 ,
N_y = 2 ,
N_x = 5 ,
Percent_Cont= 30)
#Visualization for 1, 10%
Create_Visualization(y = 2 ,
x = 5 ,
N_y = 2 ,
N_x = 5 ,
Percent_Cont= 40)
#Visualization for 1, 10%
Create_Visualization(y = 2 ,
x = 5 ,
N_y = 2 ,
N_x = 5 ,
Percent_Cont= 45)
#Visualization for 1, 10%
Create_Visualization(y = 2 ,
x = 5 ,
N_y = 2 ,
N_x = 5 ,
Percent_Cont= 41)
#Visualization for 1, 10%
Create_Visualization(y = 2 ,
x = 5 ,
N_y = 2 ,
N_x = 5 ,
Percent_Cont= 40)
#Visualization for 1, 10%
Create_Visualization(y = 2 ,
x = 2 ,
N_y = 2 ,
N_x = 2 ,
Percent_Cont= 40)
#Visualization for 1, 10%
Create_Visualization(y = 2 ,
x = 2 ,
N_y = 2 ,
N_x = 2 ,
Percent_Cont= 50)
#Visualization for 1, 10%
Create_Visualization(y = 2 ,
x = 2 ,
N_y = 2 ,
N_x = 2 ,
Percent_Cont= 60)
#Visualization for 1, 10%
Create_Visualization(y = 2 ,
x = 2 ,
N_y = 2 ,
N_x = 2 ,
Percent_Cont= 100)
#Visualization for 1, 10%
Create_Visualization(y = 5 ,
x = 2 ,
N_y = 2 ,
N_x = 2 ,
Percent_Cont= 100)
#Visualization for 1, 10%
Create_Visualization(y = 5 ,
x = 2 ,
N_y = 2 ,
N_x = 2 ,
Percent_Cont= 4)
#Visualization for 1, 10%
Create_Visualization(y = 5 ,
x = 2 ,
N_y = 2 ,
N_x = 2 ,
Percent_Cont= 10)
#Visualization for 1, 10%
Create_Visualization(y = 10 ,
x = 3 ,
N_y = 2 ,
N_x = 2 ,
Percent_Cont= 10)
#Visualization for 1, 10%
Create_Visualization(y = 10 ,
x = 5 ,
N_y = 2 ,
N_x = 2 ,
Percent_Cont= 10)
#Visualization for 1, 10%
Create_Visualization(y = 2 ,
x = 10 ,
N_y = 1 ,
N_x = 1 ,
Percent_Cont= 10)
#Visualization for 1, 10%
Create_Visualization(y = 2 ,
x = 10 ,
N_y = 1 ,
N_x = 1 ,
Percent_Cont= 20)
#Visualization for 1, 10%
Create_Visualization(y = 2 ,
x = 10 ,
N_y = 1 ,
N_x = 1 ,
Percent_Cont= 21)
#Visualization for 1, 10%
Create_Visualization(y = 2 ,
x = 10 ,
N_y = 1 ,
N_x = 1 ,
Percent_Cont= 20)
#Visualization for 1, 10%
Create_Visualization(y = 2 ,
x = 5 ,
N_y = 2 ,
N_x = 5 ,
Percent_Cont= 20)
#Visualization for 1, 10%
Create_Visualization(y = 2 ,
x = 5 ,
N_y = 2 ,
N_x = 5 ,
Percent_Cont= 5)
#Visualization for 1, 10%
Create_Visualization(y = 2 ,
x = 5 ,
N_y = 2 ,
N_x = 5 ,
Percent_Cont= 3)
#Visualization for 1, 10%
Create_Visualization(y = 2 ,
x = 5 ,
N_y = 2 ,
N_x = 5 ,
Percent_Cont= 1)
boxplot(S1_01_10$OverallPower,S1_1_10$OverallPower, S1_5_10$OverallPower, S1_10_10$OverallPower)
boxplot(S1_01_10$N_Plots_Cont,S1_1_10$N_Plots_Cont, S1_5_10$N_Plots_Cont, S1_10_10$N_Plots_Cont)
boxplot(S1_01_10$N_Plots_Positive,S1_1_10$N_Plots_Positive, S1_5_10$N_Plots_Positive, S1_10_10$N_Plots_Positive)
boxplot(S1_01_10$N_plots_Cont_Not_Pos,S1_1_10$N_plots_Cont_Not_Pos, S1_5_10$N_plots_Cont_Not_Pos, S1_10_10$$N_plots_Cont_Not_Pos)
boxplot(S1_01_10$N_plots_Cont_Not_Pos,S1_1_10$N_plots_Cont_Not_Pos, S1_5_10$N_plots_Cont_Not_Pos, S1_10_10$N_plots_Cont_Not_Pos)
boxplot(S1_01_10$OverallPower,S1_1_10$OverallPower, S1_5_10$OverallPower, S1_10_10$OverallPower)
S2_10_10<-Run_Model(Total_Sample_Size = 375,
n = 60,
CFU_lb = 10,
y = 2,
x = 5,
N_y = 1,
N_x = 5,
Percent_Cont = 100,
n_iters = 1000)
S2_10_10<-Run_Model(Total_Sample_Size = 375,
n = 60,
CFU_lb = 10,
y = 2,
x = 5,
N_y = 1,
N_x = 5,
Percent_Cont = 10,
n_iters = 1000)
boxplot(S1_01_10$OverallPower,S1_1_10$OverallPower, S1_5_10$OverallPower, S1_10_10$OverallPower,S2_10_10$OverallPower)
boxplot(S1_01_10$OverallPower,S1_1_10$OverallPower, S1_5_10$OverallPower, S1_10_10$OverallPower)
boxplot(S1_01_10$OverallPower,S1_1_10$OverallPower, S1_5_10$OverallPower, S1_10_10$OverallPower,S2_10_10$OverallPower)
Empty_df<-data.frame("OverallPower" ,
"N_Plots_Cont" ,
"N_plots_Not_Cont" ,
"N_Plots_Positive" ,
"N_plots_Cont_Not_Pos")
Empty_df
View(Empty_df)
Empty_df<-data.frame("OverallPower" = NA ,
"N_Plots_Cont" = NA,
"N_plots_Not_Cont"= NA ,
"N_Plots_Positive" = NA,
"N_plots_Cont_Not_Pos"= NA)
V_Percent_Affected<-c(0.1,1,5,10)
V_Contamination_Level<-c(10,1,0.1)
Empty_df<-data.frame("OverallPower" = NA ,
"N_Plots_Cont" = NA,
"N_plots_Not_Cont"= NA ,
"N_Plots_Positive" = NA,
"N_plots_Cont_Not_Pos"= NA,
"PerCont" = NA,
"Cont_level" = NA)
for (i in V_Percent_Affected){
for (j in V_Contamination_Level){
dfout<-Run_Model(Total_Sample_Size = 375,
n = 60,
CFU_lb = j,
y = 2,
x = 5,
N_y = 1,
N_x = 5,
Percent_Cont = i,
n_iters = 10)
dfout$PerCont = i
dfOut$Cont_level
Empty_df<-rbind(Empty_df,dfout)
}
}
for (i in V_Percent_Affected){
for (j in V_Contamination_Level){
dfout<-Run_Model(Total_Sample_Size = 375,
n = 60,
CFU_lb = j,
y = 2,
x = 5,
N_y = 1,
N_x = 5,
Percent_Cont = i,
n_iters = 10)
dfout$PerCont = i
dfout$Cont_level
Empty_df<-rbind(Empty_df,dfout)
}
}
Empty_df<-data.frame("OverallPower" = NA ,
"N_Plots_Cont" = NA,
"N_plots_Not_Cont"= NA ,
"N_Plots_Positive" = NA,
"N_plots_Cont_Not_Pos"= NA,
"PerCont" = NA,
"Cont_level" = NA)
for (i in V_Percent_Affected){
for (j in V_Contamination_Level){
dfout<-Run_Model(Total_Sample_Size = 375,
n = 60,
CFU_lb = j,
y = 2,
x = 5,
N_y = 1,
N_x = 5,
Percent_Cont = i,
n_iters = 10)
dfout$PerCont = i
dfout$Cont_level
Empty_df<-rbind(Empty_df,dfout)
}
}
for (i in V_Percent_Affected){
for (j in V_Contamination_Level){
dfout<-Run_Model(Total_Sample_Size = 375,
n = 60,
CFU_lb = j,
y = 2,
x = 5,
N_y = 1,
N_x = 5,
Percent_Cont = i,
n_iters = 10)
dfout$PerCont = i
dfout$Cont_level = j
Empty_df<-rbind(Empty_df,dfout)
}
}
Empty_df
for (i in V_Percent_Affected){
for (j in V_Contamination_Level){
dfout<-Run_Model(Total_Sample_Size = 375,
n = 60,
CFU_lb = j,
y = 2,
x = 5,
N_y = 1,
N_x = 5,
Percent_Cont = i,
n_iters = 1000)
dfout$PerCont = i
dfout$Cont_level = j
Empty_df<-rbind(Empty_df,dfout)
}
}
Empty_df
Empty_df %>%
ggplot(aes(y=OverallPower, x = Cont_level, color = PerCont))+
geom_boxplot()
Empty_df %>%
ggplot(aes(y=OverallPower, x = Cont_level, color = PerCont))+
geom_boxplot()
Empty_df[-1,]
Empty_df<-Empty_df[-1,]
Empty_df %>%
ggplot(aes(y=OverallPower, x = Cont_level, color = PerCont))+
geom_boxplot()
Empty_df %>%
ggplot(aes(y=OverallPower, x = Cont_level, grpup = factor(PerCont)))+
geom_boxplot()
Empty_df %>%
ggplot(aes(y=OverallPower, x = factor(Cont_level), grpup = factor(PerCont)))+
geom_boxplot()
Empty_df %>%
ggplot(aes(y=OverallPower, x = factor(Cont_level), color = factor(PerCont)))+
geom_boxplot()
Empty_df %>%
ggplot(aes(y=OverallPower, x = factor(Cont_level), fill = factor(PerCont)))+
geom_boxplot()
Empty_df %>%
ggplot(aes(y=OverallPower, x = factor(Cont_level), fill = factor(PerCont)))+
geom_boxplot()+
theme_bw()
Empty_df %>%
ggplot(aes(y=OverallPower, x = factor(Cont_level), fill = factor(PerCont)))+
geom_boxplot()+
theme_bw()+
labs(x = "Contamination Level (CFU/lb)", y = "Overall Probability of detecting contamination", fill = "Percentage Contaminated")
Empty_df %>%
ggplot(aes(y=OverallPower, x = factor(Cont_level), fill = factor(PerCont)))+
geom_boxplot()+
theme_bw()+
labs(x = "Contamination Level (CFU/lb)", y = "Overall Probability of detecting contamination", fill = "Percentage\n Contaminated")
Empty_df %>%
ggplot(aes(y=OverallPower, x = factor(Cont_level), fill = factor(PerCont)))+
geom_boxplot()+
theme_bw()+
labs(x = "Contamination Level (CFU/lb)", y = "Overall Probability of detecting contamination", fill = "Percentage\nContaminated")
