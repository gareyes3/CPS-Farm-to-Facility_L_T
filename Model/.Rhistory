View(Powers_summary_qs)
#Boxplot
Powers%>%
ggplot(aes(x = Type, y = value, color = Mass, fill = Mass))+
#geom_point(position=position_jitterdodge(), alpha = 0.3, size = 1)+
geom_boxplot(alpha = 0.5, outlier.shape=NA,position = position_dodge(0.6))+
scale_color_discrete(name="Sampling Plan")+
scale_fill_discrete(name="Sampling Plan")+
ylab("Sampling Plan Power")+
xlab("Sampling at Process Step")+
facet_wrap(variable~Cont, nrow =2,labeller=as_labeller(Spread_names))+
theme_bw()
Powers$variable<-as.factor(Powers$variable)
#Boxplot
Powers%>%
ggplot(aes(x = Type, y = value, color = Mass, fill = Mass))+
#geom_point(position=position_jitterdodge(), alpha = 0.3, size = 1)+
geom_boxplot(alpha = 0.5, outlier.shape=NA,position = position_dodge(0.6))+
scale_color_discrete(name="Sampling Plan")+
scale_fill_discrete(name="Sampling Plan")+
ylab("Sampling Plan Power")+
xlab("Sampling at Process Step")+
facet_wrap(variable~Cont, nrow =2,labeller=as_labeller(Spread_names))+
theme_bw()
#Boxplot
Powers%>%
ggplot(aes(x = Type, y = value, color = Mass, fill = Mass))+
#geom_point(position=position_jitterdodge(), alpha = 0.3, size = 1)+
geom_boxplot(alpha = 0.5, outlier.shape=NA,position = position_dodge(0.6))+
scale_color_discrete(name="Sampling Plan")+
scale_fill_discrete(name="Sampling Plan")+
ylab("Sampling Plan Power")+
xlab("Sampling at Process Step")+
facet_wrap(~Cont, nrow =2,labeller=as_labeller(Spread_names))+
theme_bw()
Cont_Prog<-read.csv("Data_Tomato_Outputs/SampPoint_Rep.csv")
Cont_Prog$Type[Cont_Prog$Type == "PH"] <- "Preharvest"
Cont_Prog$Type[Cont_Prog$Type == "H"] <- "Harvest"
Cont_Prog$Type[Cont_Prog$Type == "R"] <- "Receiving"
Cont_Prog$Type[Cont_Prog$Type == "PP"] <- "Packed Product"
Cont_Prog$Type<-as.factor(Cont_Prog$Type)
Cont_Prog$Pick<-as.factor(Cont_Prog$Pick)
Cont_Prog$Type<-factor(Cont_Prog$Type,levels=c("Preharvest", "Harvest", "Receiving", "Packed Product"))
Cont_Prog$`Cont.Type`<-factor(Cont_Prog$`Cont.Type`,levels=c("100%", "10%", "1%", "0.1%"))
Cont_Prog %>%
ggplot(aes(x = Type, y = Cont,color = Pick))+
#geom_point(position=position_jitterdodge(), alpha = 0.3, size = 1)+
geom_boxplot()+
xlab("Sampling Plan")+ ylab ("Total Adulteran Cells (TAC) at sampling point")+
facet_wrap(~`Cont.Type`)+
scale_y_continuous(labels = scales::comma)+
theme_bw()
Cont_Prog %>%
group_by(Type, Mass, Cont.Type) %>%
summarise(mean = mean(Cont), q95 = quantile(Cont, 0.95), q05 = quantile(Cont, 0.05))
Spread_names <-c(
"100%"= "Widespread Unclustered",
"10%" = "10% Cluster",
"1%"="1% Cluster",
"0.1%" = "0.1% Cluster"
)
Cont_Prog %>%
ggplot(aes(x = Type, y = Cont,color = Pick))+
#geom_point(position=position_jitterdodge(), alpha = 0.3, size = 1)+
geom_boxplot()+
xlab("Sampling Plan")+ ylab ("Total Adulteran Cells (TAC) at sampling point")+
facet_wrap(~`Cont.Type`)+
scale_y_continuous(labels = scales::comma,labeller=as_labeller(Spread_names))+
theme_bw()
Cont_Prog %>%
ggplot(aes(x = Type, y = Cont,color = Pick))+
#geom_point(position=position_jitterdodge(), alpha = 0.3, size = 1)+
geom_boxplot()+
xlab("Sampling Plan")+ ylab ("Total Adulteran Cells (TAC) at sampling point")+
facet_wrap(~`Cont.Type`,labeller=as_labeller(Spread_names))+
scale_y_continuous(labels = scales::comma)+
theme_bw()
ggsave(filename="Plot Outputs/Figure-S1-ContSampPoints.png",width = 25, height = 15, units = "cm", dpi = 600)
Cont_Prog<-read.csv("Data_Tomato_Outputs/PrevSampPoint_Rep.csv")
Cont_Prog$Type[Cont_Prog$Type == "PH"] <- "Preharvest"
Cont_Prog$Type[Cont_Prog$Type == "H"] <- "Harvest"
Cont_Prog$Type[Cont_Prog$Type == "R"] <- "Receiving"
Cont_Prog$Type[Cont_Prog$Type == "PP"] <- "Packed Product"
Cont_Prog$Type<-as.factor(Cont_Prog$Type)
Cont_Prog$Pick<-as.factor(Cont_Prog$Pick)
Cont_Prog$Type<-factor(Cont_Prog$Type,levels=c("Preharvest", "Harvest", "Receiving", "Packed Product"))
Cont_Prog$`Cont.Type`<-factor(Cont_Prog$`Cont.Type`,levels=c("100%", "10%", "1%", "0.1%"))
Spread_names <-c(
"100%"= "Widespread Unclustered",
"10%" = "10% Cluster",
"1%"="1% Cluster",
"0.1%" = "0.1% Cluster"
)
Cont_Prog %>%
ggplot(aes(x = Type, y = Cont,color = Pick))+
#geom_point(position=position_jitterdodge(), alpha = 0.3, size = 1)+
geom_boxplot()+
xlab("Sampling Plan")+ ylab ("Total Adulteran Cells (TAC) at sampling point")+
facet_wrap(~`Cont.Type`, scales = "free_y",labeller=as_labeller(Spread_names))+
scale_y_continuous(labels = scales::comma)+
theme_bw()
ggsave(filename="Plot Outputs/Figure-S2-PrevSampPoints.png",width = 25, height = 15, units = "cm", dpi = 600)
Cont_Prog %>%
ggplot(aes(x = Type, y = Cont,color = Pick))+
#geom_point(position=position_jitterdodge(), alpha = 0.3, size = 1)+
geom_boxplot()+
xlab("Sampling Plan")+ ylab ("Prevalence (Tomatoes> 1CFU/Tomato Tomatoes) at sampling point")+
facet_wrap(~`Cont.Type`, scales = "free_y",labeller=as_labeller(Spread_names))+
scale_y_continuous(labels = scales::comma)+
theme_bw()
Cont_Prog %>%
ggplot(aes(x = Type, y = Cont,color = Pick))+
#geom_point(position=position_jitterdodge(), alpha = 0.3, size = 1)+
geom_boxplot()+
xlab("Sampling Plan")+ ylab ("Prevalence (Tomatoes> 1CFU/Tomato Tomatoes) at sampling point")+
facet_wrap(~`Cont.Type`, scales = "free_y",labeller=as_labeller(Spread_names))+
scale_y_continuous(labels = scales::comma)+
theme_bw()
ggsave(filename="Plot Outputs/Figure-S2-PrevSampPoints.png",width = 25, height = 15, units = "cm", dpi = 600)
Exps_all<-read.csv("Data_Tomato_Outputs/Exps_Rep.csv")
Exps_all$Mass<-factor(Exps_all$Mass,levels=c("Baseline","2 Tomatoes", "6 Tomatoes", "20 Tomatoes", "60 Tomatoes","20 Tomato Mash", "60 Tomato Mash"))
Exps_all$Cont<-factor(Exps_all$Cont,levels=c("100%", "10%", "1%", "0.1%"))
Exps_all$Type<-factor(Exps_all$Type,levels=c("Baseline","Preharvest", "Harvest", "Receiving", "Packed Product"))
Exps_all %>%
ggplot(aes(x = Type, y = Total_CFU, fill = Mass))+
geom_col(position = position_dodge())+
facet_wrap(~Cont)+
scale_y_continuous(labels = scales::comma)+
ylab("Total CFU that reached the consumer")+
xlab("Sampling Location")+
theme_bw()
ggsave(filename="Plot Outputs/Exps1011.tiff",width = 25, height = 15, units = "cm", dpi = 600)
Exps_all$Cont<-factor(Exps_all$Cont,levels=c("Baseline", "100%", "10%", "1%", "0.1%"))
Exps_all$Type<-factor(Exps_all $Type,levels=c("Baseline","Preharvest", "Harvest", "Receiving", "Packed Product"))
Exps_RE<-Exps_all %>%
group_by(Cont) %>%
summarize(RE = Total_CFU/Total_CFU[Type=="Baseline"])
Exps_RE<-Exps_all %>%
select(Mass, Type, Total_CFU) %>%
bind_cols(Exps_RE)
Exps_RE$Type<-factor(Exps_RE$Type,levels=c("Baseline","Preharvest", "Harvest", "Receiving", "Packed Product"))
Exps_RE$RE<-1-Exps_RE$RE
Spread_names <-c(
"100%"= "Widespread Unclustered",
"10%" = "10% Cluster",
"1%"="1% Cluster",
"0.1%" = "0.1% Cluster"
)
Exps_RE %>%
ggplot(aes(x = Type, y = RE, shape = Mass, color = Mass))+
#geom_col(position = position_dodge())+
geom_point(position = position_dodge(width = 0.6), size =3)+
#coord_flip()+
facet_wrap(~Cont, labeller = as_labeller(Spread_names))+
xlab("Sampling at Process Stage")+
ylab("Relative Efficacy Endpoint TAC")+
theme_bw()+
scale_shape_manual(values = c(4,8,15,16,17,18,21))
ggsave(filename="Plot Outputs/Relative Efficacy.jpeg",width = 25, height = 15, units = "cm", dpi = 600)
Exps_RE %>%
ggplot(aes(x = Type, y = RE, shape = Mass, color = Mass))+
#geom_col(position = position_dodge())+
geom_point(position = position_dodge(width = 0.6), size =3)+
#coord_flip()+
facet_wrap(~Cont, labeller = as_labeller(Spread_names))+
xlab("Sampling at Process Stage")+
ylab("Relative Efficacy Endpoint TAC")+
theme_bw()+
scale_shape_manual(values = c(4,8,15,16,17,18,21))
ggsave(filename="Plot Outputs/Relative Efficacy.jpeg",width = 25, height = 15, units = "cm", dpi = 600)
Exps_RE %>%
ggplot(aes(x = Type, y = RE, shape = Mass, color = Mass))+
#geom_col(position = position_dodge())+
geom_point(position = position_dodge(width = 0.6), size =3)+
#coord_flip()+
facet_wrap(~Cont, labeller = as_labeller(Spread_names))+
xlab("Sampling at Process Stage")+
ylab("Relative Efficacy Endpoint TAC")+
theme_bw()+
scale_shape_manual(values = c(4,8,15,16,17,18,21))
ggsave(filename="Plot Outputs/Relative Efficacy.jpeg",width = 25, height = 15, units = "cm", dpi = 600)
Exps_RE %>%
ggplot(aes(x = Type, y = RE, shape = Mass, color = Mass))+
#geom_col(position = position_dodge())+
geom_point(position = position_dodge(width = 0.6), size =3)+
#coord_flip()+
facet_wrap(~Cont, labeller = as_labeller(Spread_names))+
scale_color_discrete(name="Sampling Plan")+
scale_shape_discrete(name="Sampling Plan")+
xlab("Sampling at Process Stage")+
ylab("Relative Efficacy Endpoint TAC")+
theme_bw()+
scale_shape_manual(values = c(4,8,15,16,17,18,21))
Exps_RE %>%
ggplot(aes(x = Type, y = RE, shape = Mass, color = Mass))+
#geom_col(position = position_dodge())+
geom_point(position = position_dodge(width = 0.6), size =3)+
#coord_flip()+
facet_wrap(~Cont, labeller = as_labeller(Spread_names))+
scale_color_discrete(name="Sampling Plan")+
xlab("Sampling at Process Stage")+
ylab("Relative Efficacy Endpoint TAC")+
theme_bw()+
scale_shape_manual(values = c(4,8,15,16,17,18,21),name="Sampling Plan")
ggsave(filename="Plot Outputs/Relative Efficacy.jpeg",width = 25, height = 15, units = "cm", dpi = 600)
ggsave(filename="Plot Outputs/Relative Efficacy -Additional Outputs.jpeg",width = 25, height = 15, units = "cm", dpi = 600)
TAC_ADD_RE %>%
ggplot(aes(x = Type, y = RE, shape = Mass, color = Mass))+
#geom_col(position = position_dodge())+
geom_point(position = position_dodge(width = 0.6), size =3)+
#coord_flip()+
facet_wrap(~Cont)+
xlab("Sampling at Process Stage")+
ylab("Relative Efficacy Endpoint TAC")+
theme_bw()+
scale_shape_manual(values = c(4,8,15,16,17,18,21))
Tac_ADD<-read.csv("Data_Tomato_Outputs/TAC_Additional.csv")
Tac_ADD$Mass<-as.factor(Tac_ADD$Mass)
Tac_ADD$Cont<-as.factor(Tac_ADD$Cont)
Tac_ADD$Type<-as.factor(Tac_ADD$Type)
Tac_ADD$Type<-factor(Tac_ADD$Type,levels=c("Baseline","Preharvest", "Harvest", "Receiving", "Packed Product"))
Tac_ADD$Mass<-factor(Tac_ADD$Mass,levels=c("Baseline","2 Tomatoes", "6 Tomatoes", "20 Tomatoes", "60 Tomatoes","20 Tomato Mash", "60 Tomato Mash"))
Tac_ADD$Cont<-factor(Tac_ADD$Cont,levels=c("Harvesting Bucket", "Harvesting Bin"))
TAC_ADD_RE<-Tac_ADD %>%
group_by(Cont) %>%
summarize(RE = Total_CFU/Total_CFU[Type=="Baseline"])
TAC_ADD_RE<-Tac_ADD %>%
select(Mass, Type, Total_CFU) %>%
bind_cols(TAC_ADD_RE)
TAC_ADD_RE$Type<-factor(TAC_ADD_RE$Type,levels=c("Baseline","Preharvest", "Harvest", "Receiving", "Packed Product"))
TAC_ADD_RE$RE<-1-TAC_ADD_RE$RE
TAC_ADD_RE %>%
ggplot(aes(x = Type, y = RE, shape = Mass, color = Mass))+
#geom_col(position = position_dodge())+
geom_point(position = position_dodge(width = 0.6), size =3)+
#coord_flip()+
facet_wrap(~Cont)+
xlab("Sampling at Process Stage")+
ylab("Relative Efficacy Endpoint TAC")+
theme_bw()+
scale_shape_manual(values = c(4,8,15,16,17,18,21))
ggsave(filename="Plot Outputs/Relative Efficacy -Additional Outputs.jpeg",width = 25, height = 15, units = "cm", dpi = 600)
Powers<-read.csv("Data_Tomato_Outputs/Powers_Out_Rep2B.csv")
Powers$Mass<-as.factor(Powers$Mass)
Powers$variable<-as.factor(Powers$variable)
Powers$Type<-as.factor(Powers$Type)
Powers$Type<-factor(Powers$Type,levels=c("Preharvest", "Harvest", "Receiving", "Packed Product"))
Powers$Mass<-factor(Powers$Mass,levels=c("2 Tomatoes", "6 Tomatoes", "20 Tomatoes", "60 Tomatoes","20 Tomato Mash", "60 Tomato Mash"))
Powers$Cont<-factor(Powers$Cont,levels=c("100%", "10%", "1%", "0.1%"))
Powers_Summary = Powers %>%
group_by(Type, Mass, variable, Cont) %>%
#summarise(mean = median(value), CI_95 = mean + margin_calc(value),CI_05 = mean - margin_calc(value))
summarise(mean = median(value), CI_95 = quantile(value, 0.90),CI_05 = quantile(value, 0.1))
library(tidyverse)
library(scales)
library(forcats)
Powers_Summary = Powers %>%
group_by(Type, Mass, variable, Cont) %>%
#summarise(mean = median(value), CI_95 = mean + margin_calc(value),CI_05 = mean - margin_calc(value))
summarise(mean = median(value), CI_95 = quantile(value, 0.90),CI_05 = quantile(value, 0.1))
Powers_Summary$Cont<-factor(Powers_Summary$Cont,levels=c("100%", "10%", "1%", "0.1%"))
Powers_Summary %>%
ggplot(aes(x = Type, y = mean, color = Mass,shape = variable ,group = interaction(Mass, variable)))+
#geom_point(stroke = 4,position = position_dodge(0.3))+
#geom_line(aes(linetype= variable),size = 0.3,position = position_dodge(0.3))+
geom_pointrange(aes(ymin=CI_05, ymax=CI_95),position = position_dodge(0.5), size = 0.5)+
geom_errorbar(aes(ymin=CI_05, ymax=CI_95),width = 0.5, size =0.5,position = position_dodge(0.5))+
ylab("Sampling Plan Power")+
xlab("Sampling at Process Step")+
#scale_size_manual(name = "Tomatoes Sampled")+
scale_color_discrete(name="Sampling Plan")+
scale_shape_discrete(name="Pick Number",labels = c("Power_Pick_1" ="Pick 1", "Power_Pick_2" ="Pick 2", "Power_Pick_3" ="Pick 3") )+
scale_linetype_discrete(name="Pick Number",labels = c("Power_Pick_1" ="Pick 1", "Power_Pick_2" ="Pick 2", "Power_Pick_3" ="Pick 3"))+
facet_wrap(~Cont,nrow = 2)+
theme_bw()
Spread_names <-c(
"100%"= "Random Uniform (Widespread 100% Cluster)",
"10%" = "10% Cluster",
"1%"="1% Cluster",
"0.1%" = "0.1% Cluster"
)
#Boxplot
Powers%>%
ggplot(aes(x = Type, y = value, color = Mass, fill = Mass))+
#geom_point(position=position_jitterdodge(), alpha = 0.3, size = 1)+
geom_boxplot(alpha = 0.5, outlier.shape=NA,position = position_dodge(0.6))+
scale_color_discrete(name="Sampling Plan")+
scale_fill_discrete(name="Sampling Plan")+
ylab("Sampling Plan Power")+
xlab("Sampling at Process Step")+
facet_wrap(~Cont, nrow =2,labeller=as_labeller(Spread_names))+
theme_bw()
Spread_names <-c(
"100%"= "Random Uniform (Widespread 100% Cluster)",
"10%" = "10% Cluster",
"1%"="1% Cluster",
"0.1%" = "0.1% Cluster"
)
#Boxplot
Powers%>%
ggplot(aes(x = Type, y = value, color = Mass, fill = Mass))+
#geom_point(position=position_jitterdodge(), alpha = 0.3, size = 1)+
geom_boxplot(alpha = 0.5, outlier.shape=NA,position = position_dodge(0.6))+
scale_color_discrete(name="Sampling Plan")+
scale_fill_discrete(name="Sampling Plan")+
ylab("Sampling Plan Power")+
xlab("Sampling at Process Step")+
facet_wrap(~Cont, nrow =2,labeller=as_labeller(Spread_names))+
theme_bw()
#ggsave(filename="Plot Outputs/Powers1011.tiff",width = 25, height = 15, units = "cm", dpi = 600)
ggsave(filename="Plot Outputs/Powers1011.png",width = 25, height = 15, units = "cm", dpi = 600)
setwd("~/GitHub/CPS-Farm-to-Facility_L_T/Model")
#ggsave(filename="Plot Outputs/Powers1011.tiff",width = 25, height = 15, units = "cm", dpi = 600)
ggsave(filename="Plot Outputs/Powers1011.png",width = 25, height = 15, units = "cm", dpi = 600)
Powers$Mass<-as.factor(Powers$Mass)
Powers$variable<-as.factor(Powers$variable)
Powers$Type<-as.factor(Powers$Type)
Powers$Type<-factor(Powers$Type,levels=c("Preharvest", "Harvest", "Receiving", "Packed Product"))
Powers$Mass<-factor(Powers$Mass,levels=c("2 Tomatoes", "6 Tomatoes", "20 Tomatoes", "60 Tomatoes","20 Tomato Mash", "60 Tomato Mash"))
Powers$Cont<-factor(Powers$Cont,levels=c("100%", "10%", "1%", "0.1%"))
```
Powers<-read.csv("Data_Tomato_Outputs/Powers_Out_Rep2B.csv")
Powers$Mass<-as.factor(Powers$Mass)
Powers$variable<-as.factor(Powers$variable)
Powers$Type<-as.factor(Powers$Type)
Powers$Type<-factor(Powers$Type,levels=c("Preharvest", "Harvest", "Receiving", "Packed Product"))
Powers$Mass<-factor(Powers$Mass,levels=c("2 Tomatoes", "6 Tomatoes", "20 Tomatoes", "60 Tomatoes","20 Tomato Mash", "60 Tomato Mash"))
Powers$Cont<-factor(Powers$Cont,levels=c("100%", "10%", "1%", "0.1%"))
Powers$Mass<-as.factor(Powers$Mass)
Powers$variable<-as.factor(Powers$variable)
Powers$Type<-as.factor(Powers$Type)
Powers$Type<-factor(Powers$Type,levels=c("Preharvest", "Harvest", "Receiving", "Packed Product"))
Powers$Mass<-factor(Powers$Mass,levels=c("2 Tomatoes", "6 Tomatoes", "20 Tomatoes", "60 Tomatoes","20 Tomato Mash", "60 Tomato Mash"))
Powers$Cont<-factor(Powers$Cont,levels=c("100%", "10%", "1%", "0.1%"))
Powers<-read.csv("Data_Tomato_Outputs/Powers_Out_Rep2B.csv")
Powers$Mass<-as.factor(Powers$Mass)
Powers$variable<-as.factor(Powers$variable)
Powers$Type<-as.factor(Powers$Type)
Powers$Type<-factor(Powers$Type,levels=c("Preharvest", "Harvest", "Receiving", "Packed Product"))
Powers$Mass<-factor(Powers$Mass,levels=c("2 Tomatoes", "6 Tomatoes", "20 Tomatoes", "60 Tomatoes","20 Tomato Mash", "60 Tomato Mash"))
Powers$Cont<-factor(Powers$Cont,levels=c("100%", "10%", "1%", "0.1%"))
Powers_Summary = Powers %>%
group_by(Type, Mass, variable, Cont) %>%
#summarise(mean = median(value), CI_95 = mean + margin_calc(value),CI_05 = mean - margin_calc(value))
summarise(mean = median(value), CI_95 = quantile(value, 0.90),CI_05 = quantile(value, 0.1))
Powers_Summary$Cont<-factor(Powers_Summary$Cont,levels=c("100%", "10%", "1%", "0.1%"))
Powers_Summary %>%
ggplot(aes(x = Type, y = mean, color = Mass,shape = variable ,group = interaction(Mass, variable)))+
#geom_point(stroke = 4,position = position_dodge(0.3))+
#geom_line(aes(linetype= variable),size = 0.3,position = position_dodge(0.3))+
geom_pointrange(aes(ymin=CI_05, ymax=CI_95),position = position_dodge(0.5), size = 0.5)+
geom_errorbar(aes(ymin=CI_05, ymax=CI_95),width = 0.5, size =0.5,position = position_dodge(0.5))+
ylab("Sampling Plan Power")+
xlab("Sampling at Process Step")+
#scale_size_manual(name = "Tomatoes Sampled")+
scale_color_discrete(name="Sampling Plan")+
scale_shape_discrete(name="Pick Number",labels = c("Power_Pick_1" ="Pick 1", "Power_Pick_2" ="Pick 2", "Power_Pick_3" ="Pick 3") )+
scale_linetype_discrete(name="Pick Number",labels = c("Power_Pick_1" ="Pick 1", "Power_Pick_2" ="Pick 2", "Power_Pick_3" ="Pick 3"))+
facet_wrap(~Cont,nrow = 2)+
theme_bw()
Spread_names <-c(
"100%"= "Random Uniform (Widespread 100% Cluster)",
"10%" = "10% Cluster",
"1%"="1% Cluster",
"0.1%" = "0.1% Cluster"
)
#Boxplot
Powers%>%
ggplot(aes(x = Type, y = value, color = Mass, fill = Mass))+
#geom_point(position=position_jitterdodge(), alpha = 0.3, size = 1)+
geom_boxplot(alpha = 0.5, outlier.shape=NA,position = position_dodge(0.6))+
scale_color_discrete(name="Sampling Plan")+
scale_fill_discrete(name="Sampling Plan")+
ylab("Sampling Plan Power")+
xlab("Sampling at Process Step")+
facet_wrap(~Cont, nrow =2,labeller=as_labeller(Spread_names))+
theme_bw()
#ggsave(filename="Plot Outputs/Powers1011.tiff",width = 25, height = 15, units = "cm", dpi = 600)
ggsave(filename="Plot Outputs/Powers1011.png",width = 25, height = 15, units = "cm", dpi = 600)
Cont_Prog<-read.csv("Data_Tomato_Outputs/SampPoint_Rep.csv")
Cont_Prog$Type[Cont_Prog$Type == "PH"] <- "Preharvest"
Cont_Prog$Type[Cont_Prog$Type == "H"] <- "Harvest"
Cont_Prog$Type[Cont_Prog$Type == "R"] <- "Receiving"
Cont_Prog$Type[Cont_Prog$Type == "PP"] <- "Packed Product"
Cont_Prog$Type<-as.factor(Cont_Prog$Type)
Cont_Prog$Pick<-as.factor(Cont_Prog$Pick)
Cont_Prog$Type<-factor(Cont_Prog$Type,levels=c("Preharvest", "Harvest", "Receiving", "Packed Product"))
Cont_Prog$`Cont.Type`<-factor(Cont_Prog$`Cont.Type`,levels=c("100%", "10%", "1%", "0.1%"))
Spread_names <-c(
"100%"= "Random Uniform (Widespread 100% Cluster)",
"10%" = "10% Cluster",
"1%"="1% Cluster",
"0.1%" = "0.1% Cluster"
)
Cont_Prog %>%
ggplot(aes(x = Type, y = Cont,color = Pick))+
#geom_point(position=position_jitterdodge(), alpha = 0.3, size = 1)+
geom_boxplot()+
xlab("Sampling Plan")+ ylab ("Total Adulteran Cells (TAC) at sampling point")+
facet_wrap(~`Cont.Type`,labeller=as_labeller(Spread_names))+
scale_y_continuous(labels = scales::comma)+
theme_bw()
ggsave(filename="Plot Outputs/Figure-S1-ContSampPoints.png",width = 25, height = 15, units = "cm", dpi = 600)
Cont_Prog %>%
group_by(Type, Mass, Cont.Type) %>%
summarise(mean = mean(Cont), q95 = quantile(Cont, 0.95), q05 = quantile(Cont, 0.05))
Cont_Prog<-read.csv("Data_Tomato_Outputs/PrevSampPoint_Rep.csv")
Cont_Prog$Type[Cont_Prog$Type == "PH"] <- "Preharvest"
Cont_Prog$Type[Cont_Prog$Type == "H"] <- "Harvest"
Cont_Prog$Type[Cont_Prog$Type == "R"] <- "Receiving"
Cont_Prog$Type[Cont_Prog$Type == "PP"] <- "Packed Product"
Cont_Prog$Type<-as.factor(Cont_Prog$Type)
Cont_Prog$Pick<-as.factor(Cont_Prog$Pick)
Cont_Prog$Type<-factor(Cont_Prog$Type,levels=c("Preharvest", "Harvest", "Receiving", "Packed Product"))
Cont_Prog$`Cont.Type`<-factor(Cont_Prog$`Cont.Type`,levels=c("100%", "10%", "1%", "0.1%"))
Spread_names <-c(
"100%"= "Random Uniform (Widespread 100% Cluster)",
"10%" = "10% Cluster",
"1%"="1% Cluster",
"0.1%" = "0.1% Cluster"
)
Cont_Prog %>%
ggplot(aes(x = Type, y = Cont,color = Pick))+
#geom_point(position=position_jitterdodge(), alpha = 0.3, size = 1)+
geom_boxplot()+
xlab("Sampling Plan")+ ylab ("Prevalence (Tomatoes> 1CFU/Tomato Tomatoes) at sampling point")+
facet_wrap(~`Cont.Type`, scales = "free_y",labeller=as_labeller(Spread_names))+
scale_y_continuous(labels = scales::comma)+
theme_bw()
ggsave(filename="Plot Outputs/Figure-S2-PrevSampPoints.png",width = 25, height = 15, units = "cm", dpi = 600)
Cont_Prog %>%
group_by(Type, `Cont.Type`) %>%
summarise(mean = mean(Cont), q95 = quantile(Cont, 0.95), q05 = quantile(Cont, 0.05))
Exps_all<-read.csv("Data_Tomato_Outputs/Exps_Rep.csv")
Exps_all$Mass<-factor(Exps_all$Mass,levels=c("Baseline","2 Tomatoes", "6 Tomatoes", "20 Tomatoes", "60 Tomatoes","20 Tomato Mash", "60 Tomato Mash"))
Exps_all$Cont<-factor(Exps_all$Cont,levels=c("100%", "10%", "1%", "0.1%"))
Exps_all$Type<-factor(Exps_all$Type,levels=c("Baseline","Preharvest", "Harvest", "Receiving", "Packed Product"))
Spread_names <-c(
"100%"= "Random Uniform (Widespread 100% Cluster)",
"10%" = "10% Cluster",
"1%"="1% Cluster",
"0.1%" = "0.1% Cluster"
)
Exps_all %>%
ggplot(aes(x = Type, y = Total_CFU, fill = Mass))+
geom_col(position = position_dodge())+
facet_wrap(~Cont,labeller=as_labeller(Spread_names))+
scale_y_continuous(labels = scales::comma)+
ylab("Total CFU that reached the consumer")+
xlab("Sampling Location")+
theme_bw()
ggsave(filename="Plot Outputs/Exps1011.jpeg",width = 25, height = 15, units = "cm", dpi = 600)
Exps_all$Cont<-factor(Exps_all$Cont,levels=c("Baseline", "100%", "10%", "1%", "0.1%"))
Exps_all$Type<-factor(Exps_all $Type,levels=c("Baseline","Preharvest", "Harvest", "Receiving", "Packed Product"))
Exps_RE<-Exps_all %>%
group_by(Cont) %>%
summarize(RE = Total_CFU/Total_CFU[Type=="Baseline"])
Exps_RE<-Exps_all %>%
select(Mass, Type, Total_CFU) %>%
bind_cols(Exps_RE)
Exps_RE$Type<-factor(Exps_RE$Type,levels=c("Baseline","Preharvest", "Harvest", "Receiving", "Packed Product"))
Exps_RE$RE<-1-Exps_RE$RE
Spread_names <-c(
"100%"= "Widespread Unclustered",
"10%" = "10% Cluster",
"1%"="1% Cluster",
"0.1%" = "0.1% Cluster"
)
Exps_RE %>%
ggplot(aes(x = Type, y = RE, shape = Mass, color = Mass))+
#geom_col(position = position_dodge())+
geom_point(position = position_dodge(width = 0.6), size =3)+
#coord_flip()+
facet_wrap(~Cont, labeller = as_labeller(Spread_names))+
scale_color_discrete(name="Sampling Plan")+
xlab("Sampling at Process Stage")+
ylab("Relative Efficacy Endpoint TAC")+
theme_bw()+
scale_shape_manual(values = c(4,8,15,16,17,18,21),name="Sampling Plan")
#ggsave(filename="Plot Outputs/Relative Efficacy.tiff",width = 25, height = 15, units = "cm", dpi = 600)
ggsave(filename="Plot Outputs/Relative Efficacy.jpeg",width = 25, height = 15, units = "cm", dpi = 600)
write.csv(Exps_RE, file = "Exps_RE.csv")
Exps_all$Cont<-factor(Exps_all$Cont,levels=c("Baseline", "100%", "10%", "1%", "0.1%"))
Exps_all$Type<-factor(Exps_all $Type,levels=c("Baseline","Preharvest", "Harvest", "Receiving", "Packed Product"))
Exps_RE<-Exps_all %>%
group_by(Cont) %>%
summarize(RE = Total_CFU/Total_CFU[Type=="Baseline"])
Exps_RE<-Exps_all %>%
select(Mass, Type, Total_CFU) %>%
bind_cols(Exps_RE)
Exps_RE$Type<-factor(Exps_RE$Type,levels=c("Baseline","Preharvest", "Harvest", "Receiving", "Packed Product"))
Exps_RE$RE<-1-Exps_RE$RE
Spread_names <-c(
"100%"= "Random Uniform (Widespread 100% Cluster)",
"10%" = "10% Cluster",
"1%"="1% Cluster",
"0.1%" = "0.1% Cluster"
)
Exps_RE %>%
ggplot(aes(x = Type, y = RE, shape = Mass, color = Mass))+
#geom_col(position = position_dodge())+
geom_point(position = position_dodge(width = 0.6), size =3)+
#coord_flip()+
facet_wrap(~Cont, labeller = as_labeller(Spread_names))+
scale_color_discrete(name="Sampling Plan")+
xlab("Sampling at Process Stage")+
ylab("Relative Efficacy Endpoint TAC")+
theme_bw()+
scale_shape_manual(values = c(4,8,15,16,17,18,21),name="Sampling Plan")
#ggsave(filename="Plot Outputs/Relative Efficacy.tiff",width = 25, height = 15, units = "cm", dpi = 600)
ggsave(filename="Plot Outputs/Relative Efficacy.jpeg",width = 25, height = 15, units = "cm", dpi = 600)
write.csv(Exps_RE, file = "Exps_RE.csv")
